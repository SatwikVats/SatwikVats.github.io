<!doctype html><html><head><title>Day 16</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/layouts/main.css><link rel=stylesheet href=/css/navigators/navbar.css><link rel=stylesheet href=/css/plyr.css><link rel=stylesheet href=/css/flag-icon.min.css><link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css><meta property="og:title" content="Day 16"><meta property="og:description" content="An attempt to deploy a VM as an IAM user.
  Created a directory and initialized Terraform in it.    Installed AWS CLI package whic is required for using aws commands.
  Used aws configure to provide necessary fields like Access Key ID, Secret Access Key, Default Region and Default Output Format.    Though, the since the credentials were revoked, it didn&rsquo;t work out."><meta property="og:type" content="article"><meta property="og:url" content="https://satwikvats.github.io/posts/daily-updates/day16/"><meta property="article:published_time" content="2020-06-08T06:00:20+06:00"><meta property="article:modified_time" content="2020-06-08T06:00:20+06:00"><meta name=description content="Day 16"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css><link rel=stylesheet href=/css/layouts/single.css><link rel=stylesheet href=/css/navigators/sidebar.css><link rel=stylesheet href=/css/style.css></head><body data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button onclick=toggleSidebar()>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/>Know me better..</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button onclick=toggleTOC()>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"></ul></div></div></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts data-filter=all>Posts</a></li><div class=subtree><li><a href=/posts/ansible/ title=Ansible>Ansible</a></li><li><a href=/posts/docker/ title=Docker>Docker</a></li><li><a href=/posts/github-actions/ title="Github Actions">Github Actions</a></li><li><a href=/posts/hugo/ title=Hugo>Hugo</a></li><li><a href=/posts/introduction/ title=Introduction>Introduction</a></li><li><a href=/posts/kubernetes/ title=Kubernetes>Kubernetes</a></li><li><a href=/posts/my-venture-at-npbridge-solutions/ title="My Venture at NPBridge Solutions">My Venture at NPBridge Solutions</a></li><li><a href=/posts/netlify/ title=Netlify>Netlify</a></li><li><a href=/posts/terraform/ title=Terraform>Terraform</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/daily-updates/>Daily Updates</a><ul class=active><li><a href=/posts/daily-updates/day19/ title="1 July">1 July</a></li><li><a href=/posts/daily-updates/day7/ title="15 June">15 June</a></li><li><a href=/posts/daily-updates/day8/ title="16 June">16 June</a></li><li><a href=/posts/daily-updates/day9/ title="17 June">17 June</a></li><li><a href=/posts/daily-updates/day10/ title="18 June">18 June</a></li><li><a href=/posts/daily-updates/day20/ title="2 July">2 July</a></li><li><a href=/posts/daily-updates/day11/ title="21 June">21 June</a></li><li><a href=/posts/daily-updates/day12/ title="22 June">22 June</a></li><li><a class=active href=/posts/daily-updates/day16/ title="28 June">28 June</a></li><li><a href=/posts/daily-updates/day18/ title="30 June">30 June</a></li><li><a href=/posts/daily-updates/day21/ title="5 July">5 July</a></li><li><a href=/posts/daily-updates/day22/ title="6 July">6 July</a></li><li><a href=/posts/daily-updates/day23/ title="7 July">7 July</a></li><li><a href=/posts/daily-updates/day24/ title="8 July">8 July</a></li><li><a href=/posts/daily-updates/day25/ title="9 July">9 July</a></li><li><a href=/posts/daily-updates/day1/ title="Day 1">Day 1</a></li><li><a href=/posts/daily-updates/day2/ title="Day 2">Day 2</a></li><li><a href=/posts/daily-updates/day3/ title="Day 3">Day 3</a></li><li><a href=/posts/daily-updates/day4/ title="Day 4">Day 4</a></li><li><a href=/posts/daily-updates/day5/ title="Day 5">Day 5</a></li><li><a href=/posts/daily-updates/day6/ title="Day 6">Day 6</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(https://satwikvats.github.io/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/default-avatar_hu1b14593c51b09e0fcd18693678a8f4ed_42371_120x120_fit_box_2.png alt="Author Image"><h5 class=author-name></h5><p>June 8, 2020</p></div><div class=title><h1>Day 16</h1></div><div class=post-content id=post-content><ul><li><p>An attempt to deploy a VM as an IAM user.</p><ul><li><p>Created a directory and initialized Terraform in it.
<script src=https://asciinema.org/a/45q0k5gvvUmmZrHv3ccpPjxJZ.js id=asciicast-45q0k5gvvUmmZrHv3ccpPjxJZ async></script></p></li><li><p>Installed AWS CLI package whic is required for using <code>aws</code> commands.</p></li><li><p>Used <code>aws configure</code> to provide necessary fields like Access Key ID, Secret Access Key, Default Region and Default Output Format.
<script src=https://asciinema.org/a/YrDwVH8WqTOOt5lLNx6tmSjxo.js id=asciicast-YrDwVH8WqTOOt5lLNx6tmSjxo async></script></p></li><li><p>Though, the since the credentials were revoked, it didn&rsquo;t work out.</p></li></ul></li><li><p>Started making my own web-server using Terraform.</p><ul><li><p>Defined the required resources listed as follows.</p><pre><code>provider &quot;aws&quot; {
region  = &quot;ap-south-1&quot;
access_key = &quot;AKIAZNAFREL3FOSYINVD&quot;
secret_key = &quot;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&quot;
}

resource &quot;aws_vpc&quot; &quot;prod-vpc&quot; {
cidr_block = &quot;10.0.0.0/16&quot;
tags = {
Name = &quot;production_vpc&quot;
}
}

#To have a public address, we need to have an internet gateway.
resource &quot;aws_internet_gateway&quot; &quot;gw&quot; {
vpc_id = aws_vpc.prod-vpc.id

}

resource &quot;aws_route_table&quot; &quot;prod-route-table&quot; {
vpc_id = aws_vpc.prod-vpc.id

route {
cidr_block = &quot;0.0.0.0/0&quot;
gateway_id = aws_internet_gateway.gw.id
}

route {
ipv6_cidr_block        = &quot;::/0&quot;
egress_only_gateway_id = aws_internet_gateway.gw.id
}

tags = {
Name = &quot;prod&quot;
}
}

#Hard-coded the availability zone.
resource &quot;aws_subnet&quot; &quot;subnet-1&quot; {
vpc_id     = aws_vpc.main.id
cidr_block = &quot;10.0.1.0/24&quot;
availability_zone = &quot;ap-south-1a&quot;

tags = {
Name = &quot;Main&quot;
}
}

resource &quot;aws_route_table_association&quot; &quot;a&quot; {
subnet_id      = aws_subnet.subnet-1.id
route_table_id = aws_route_table.prod-route-table.id
}

resource &quot;aws_security_group&quot; &quot;allow_traffic&quot; {
name        = &quot;allow_traffic&quot;
description = &quot;Allow web traffic&quot;
vpc_id      = aws_vpc.prod-vpc.id

ingress {
description      = &quot;HTTP&quot;
from_port        = 70
to_port          = 70
protocol         = &quot;tcp&quot;
cidr_blocks      = [0.0.0.0/0]
}

ingress {
description      = &quot;SSH&quot;
from_port        = 5
to_port          = 5
protocol         = &quot;tcp&quot;
cidr_blocks      = [0.0.0.0/0]
}


egress {
from_port        = 0
to_port          = 0
protocol         = &quot;-1&quot;
cidr_blocks      = [&quot;0.0.0.0/0&quot;]
ipv6_cidr_blocks = [&quot;::/0&quot;]
}

tags = {
Name = &quot;allow_tls&quot;
}
}

resource &quot;aws_network_interface&quot; &quot;web-server-1&quot; {
subnet_id       = aws_subnet.subnet-1.id
private_ips     = [&quot;10.0.1.50&quot;]
security_groups = [aws_security_group.allow_traffic.id]

}

resource &quot;aws_eip&quot; &quot;one&quot; {
vpc                       = true
network_interface         = aws_network_interface.web-server-1.id
associate_with_private_ip = &quot;10.0.0.50&quot;
depends_on = aws_internet_gateway.gw.id
}
   
#launching an ubuntu server
resource &quot;aws_instance&quot; &quot;web-server-instance&quot; {
ami = &quot;ami-0c1a7f89451184c8b&quot;
instance_type = &quot;t2.micro&quot;
availability_zone = &quot;ap-south-1a&quot;
key_name = &quot;main-key&quot;

network_interface {
device_index = 0
network_interface_id = aws_network_interface.web-server-1.id
}
}
   
</code></pre></li><li><p>Terminal recording for the same.
<script src=https://asciinema.org/a/x7YDxkt9W9JkKfxz7pWNfrkOi.js id=asciicast-x7YDxkt9W9JkKfxz7pWNfrkOi async></script></p></li></ul></li><li><p>Few pointers to keep in mind.</p><ul><li><p>Specifying IP as 0.0.0.0/0 indicates that our traffic can go/come from any IP address on the internet.</p></li><li><p>We may assign multiple IPs for network interface.</p></li><li><p>We must use the same private ip for aws_eip, the one we used for network interface.</p></li><li><p>We must use the same availability zone for subnet as well as Ubuntu server.</p></li><li><p>An availability zone may have multiple data centres. In case of a failure, other would work fine and hence, it is advisable to hard-code the availability zone with data-centre.</p></li></ul></li><li><p>References-</p><ul><li><a href="https://www.youtube.com/watch?v=SLB_c_ayRMo&t=5847s">Automating your AWS Cloud Infrastructure</a></li></ul></li></ul></div><div class=btn-improve-page><a href=https://github.com/hugo-toha/hugo-toha.github.io/edit/main/content/posts/Daily%20Updates/Day16.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>Improve this page</a></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/daily-updates/day12/ title="Day 12" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i>Prev</div><div class=next-prev-text>Day 12</div></a></div><div class="col-md-6 next-article"><a href=/posts/daily-updates/day18/ title="Day 18" class="btn btn-outline-info"><div>Next <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Day 18</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents></nav></div></div></section></div><footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=/#about>About</a></li><li class=nav-item><a class=smooth-scroll href=/#recent-posts>Recent Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul></ul></div></div></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hossainemruz/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_2.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">Â© 2020 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script type=text/javascript src=/js/jquery-3.4.1.min.js></script><script type=text/javascript src=/js/popper.min.js></script><script type=text/javascript src=/js/bootstrap.min.js></script><script type=text/javascript src=/js/navbar.js></script><script type=text/javascript src=/js/plyr.js></script><script type=text/javascript src=/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js></script><script src=/js/single.js></script><script>hljs.initHighlightingOnLoad();</script></body></html>